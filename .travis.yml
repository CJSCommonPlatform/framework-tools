dist: trusty
sudo: false
language: java
jdk:
- oraclejdk8
git:
  cache: 3
cache:
  directories:
  - "$HOME/.m2"
services:
  - postgresql
before_script:
  - psql -c 'create database frameworkeventstore;' -U postgres
  - psql -c 'create database frameworkviewstore;' -U postgres
  - psql -c 'create database frameworkfilestore;' -U postgres
  - psql -c "CREATE USER framework WITH PASSWORD 'framework';" -U postgres
addons:
  postgresql: "9.5"
  sonarcloud:
    organization: cjscommonplatform
    token:
      secure: cI35fUU7Gg4GbwgBC+4E2pGwNTemb7cyqmpHybRlgMa+ZGIKby9XNa0jFrih1agv8Lnm2YvugwzH570W35G5+tx8uDU0dpwUt5gyzHgkouSuKE7ztB8kF7OEdScfMJmrpabuD9P7Itz7BpvAiJBLdtk0a0vsV8Fzd0l1Sr3O3ur5m16PSb1ZSq3QJYhbPUfnhtfdPFxO++7xyZP2dBUcTDTtLVHIGe2p/tR/Nj63VO+DWdj7GNeHyyNuou5x7hdeA7tuBYY+BzK8GYzFsxJxK2lCslJjAEl8gQUTlB971sHAQUg18EWO7KypmoUE8dgCPgSN2M6h2IuUG6esFsyOJrzvn0BhuTFKylYsQvDm5aPtQZHL/DJ731wlkkf/mP0aDY8Ujl0DIBPBbCUBZiR0hhJfW05Os3OgbWy+IZ38J5NxObDj1pIbcliXbZegXQzgkC92u2yxzg0o5KMtEGHwg6JOqSnJD6N44U4aTEiCq2iBMSDfMhNUOxBbw3on/bXqcrUyaEjAGglh7P0r1lWnMzl3CgC6HYlFWI30dCnlLQJEMoZACNmE+yS4qOGnmHPtkq7bWjDhYAoEO7Oy+a3ZGs57q3eAEoI2PPp4ApOSAEoSPE5kOn+tXYxO9htkl9XCyaQK0n2FrJ2AKlqGfDOAW1lmLLdzj1DhhxqqHwc9o6E=
    github_token:
      secure: bft56m1xd8tjv6U7+io+hUFB//wsBWdVH3CNZUjLPgm5e/Uos+YufqUnPa+ZBcFf5IzyDjNKHUxHUouFLIAGw+LR2Avm//1cbhzQ2aGxkLjgqMR7VxtxCFefoOZnwXy5+5hjPTm9FBA6qLp9K1hePkB1EuSQSgiAzTe87eChWu5UeLywXWAoLWUS5rPQPaTzZ+lVbBw4tauQLCatOagYN0fcIutbZW73FV/PWgjZ0rx3N0oQvQKgjCVDj+n1H6jIpkQzoXpPEtKQsgJOZNJ2EDgUgox5voEzl90IVocdAxuGZ5spSjFSF6vWw6yC+KRyMA5woXCMQpdLVaEZA7D8rBlBsH4ya9U+mUCy/1BbCe0s8dnIWQExj1KxUSmwQ21fE/D/WXYv+4qp+3GxqtXRbwP6lQjyoLVv42N0YoUbYXaZDqLPy3pAWbbvlFkSpnTf48puJrzo16AivrSaWmvi4OhnjtTmxAFc7xK277ZO+WbTx6dO20DV2O9HinVqg7upsC2pZ5XFNSOQSrRwwQLnKr77SDvXscHNOZcW1CY9OlS737Ile6OVfF19co7aCpO/AG3kBkb/iV6+uoVe1Z3Ep1Ke2oC/Orsx3N4PXbpypr+lJeTL9AlqKeEawNnPqhlYDF76vZ1jTBAbsiPQilV1l3bWQ6XA6clERgEgCDFRX7s=
before_install:
- git clone https://github.com/CJSCommonPlatform/travis-settings.git target/travis-settings
- ln -sfT ${PWD}/target/travis-settings/settings.xml ${HOME}/.m2/settings.xml
install: "${PWD}/target/travis-settings/java/install.sh -e -q -DexcludeGroupIds=uk.gov.justice.service,uk.gov.justice.services"
script: "${PWD}/target/travis-settings/java/script-install.sh coveralls:report sonar:sonar"
after_success: "${PWD}/target/travis-settings/java/after_success.sh"
env:
  global:
  - secure: BRSJ5hIFNiXtOwq8qQfxFCoi+DghyCF4YoKK+xZz3BIHF+VN9LK5i99Be9e/eYsmo3b055UgaFJyrjMfjilj9Phu53VKeRd0BR9s8C06z8xxxjR5F5bxi2GzOYQDFauijYDhef4nt+rEGkA3sZ5qyHgKZYleD6RIbX40u+YfU7Wa12vjBBzoMF/guRg1Z/PZpKrGB/WiBhkmE3aF7tcWvgiBtMU74Vdf/Izv/FKFzP9wUEoambW+9E6XaP4MsqbLWhUg2W7ZJONudNqbqUaM600400IZis1sdeD/8lEsoEWPmhz1zjbRrKQXRpHyR86xtNnhvKmtzxAhiKrlOj/5AakttinoLSDay7VesYVCpHyYSRX2xlgds36clypqmlX2LvkmGFzIFasSBiSUyK+cSwsNV1dHFxDazHLrMt/DRuYn3FnyEd4E7Vza/OtOXHyP/IVm0UXFidpPAn3y3zvu96GDwFjz9b5q11Y3qrxyCj21G5FLN6qInKQYBu1ChcNBAPDZtGyVlpxVhyqgO3b9dTTsIMD6mxMvOweJYG4wfrKOuctRSqxr5YKpfk6TQwzDvIEw/iMmT38fRQzg0fgd20XKiMrLSXhG3GpHS0NPecjXqZZq/hknck4fqgg1CwY9sW8mg3jhEDkBhik14QL7Jqy52ufKL+EVzDxScl0dmXM=
  - secure: PN6h2UE/x/VRUzaYiMSyoTNAlC03c+GUXpP/oRojoqVe/UxQ+NWbffDDu251jKSjZ3PVtRvUolVao8s5GMH81K0csv8M+HxxVeUrRDgCW2TOrggFJtex4ww8dUVXsKBtIlojTcLBW2qEwF5Qpky7jwRFy8oke5lhM2tPx2NNYWzoee+IDAn12yDDW676Apmvofj2UO/htyZrNhJNc1jSbcaemCA4rcTBemkojd2o9TsiUNlb8Ve6JfU9iKjgsqg+EFwME4zdVqXRF7DiFW2pMd9HmdFVVA9RM02pdr77HIPatCvDmmqkA99cIyn4iMNe5L0QI0eUhpMKpjFJwSpsgIBr9gE0gzYJIbbldNuvXr87K1Snte/nxPIFs6iu86ebdcENX/h10s9hAgDuoIbW7FWkzLTeeWh/+Yk/eGD/DFPZ1GpZEAi/mxSUzaT1pa+jMrmf3MIq/5Vcojm7H7wRAlkDBlZs5KT9OUZI8on1pC3xksML9WiEEkfemQ+5Ij1e0k7Pj6UpF2lKR0keZ5GS5JoDxQPegs/IL2X2riPtW6xW5JKxPwS0qZtfUKGfO1y5KEIb6OyWq9s20HkB/NG3z+zwaCRvWQ/oRpgsybkkZPQ626AhR9JMCsLxIAKubEXlt3YpnLpu6Wh4ZAXN/hEwdYGPVTrF5hn6ML353+3i6Jc=
  - PGPORT=5432
